import json
import pandas as pd
import datetime

file = 'articles20201030.json'

with open(file) as f:
  data = json.load(f)

def unpack(df, column, fillna=None):
    ret = None
    if fillna is None:
        ret = pd.concat([df, pd.DataFrame((d for idx, d in df[column].iteritems()))], axis=1)
        del ret[column]
    else:
        ret = pd.concat([df, pd.DataFrame((d for idx, d in df[column].iteritems())).fillna(fillna)], axis=1)
        del ret[column]
    return ret

def write_csv():
  df = pd.DataFrame.from_dict(data['articles'])
  df = unpack(df, 'source')
  with open('Article_Content', 'a') as f:
    df.to_csv(f, header=False)

# UNCOMMENT LINE BELOW TO RUN THE CODE AND COMPILE
#write_csv()
print(file, datetime.datetime.now().time())